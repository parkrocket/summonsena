<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Summon길드 쿠폰입력하기</title>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NJTZY0W968"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" />
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <div style="position:absolute; top:0px; left:0px; width:100%; height:100%;">
        <div style="width:50%; height:100%; position:fixed; top:0; right:-410px; background-image: url('img/right.jpg'); background-repeat: no-repeat; background-position: 100% 0px;"></div>
        <div style="width:50%; height:100%; position:fixed; top:0; left:-410px; background-image: url('img/left.jpg'); background-repeat: no-repeat; background-position: 100% 0px;"></div>
    </div>
    <div id="wrap" style="position:relative">
        <div id="sbj">
            <p>2022 세븐나이츠2 대보물시대 쿠폰 자동입력기</p>
            <p id="sig" style="">- Summon길드 유니코드</p>
        </div>
        <div id="top_wrap">
            <div id="left_dv">
                <p>회원번호를 입력하세요.<a href="https://forum.netmarble.com/sk2/view/13/746266" target="_blank" rel="noopener noreferrer" style="float:right; color:#222">회원번호란?</a></p>
                <p><input type="text" id="uid" style="" class="form-control" ><button onclick="req();"  class="form-control btns">입력완료</button></p>
                <p style="text-align: right;"></p>
                <div id="issue_wrap">
                    <h3>Issue</h3>
                    <p>22/04/26 쿠폰갯수 39개, 보상내역 추가</p>
                    <p style="font-size:11px; color:#5a5a5a; line-height: -20px; ">※ 쿠폰번호는 상시 업데이트중입니다.</p>
                </div>
            </div>
            <div id="right_dv">
                <h3>세븐나이츠2 Summon 길드</h3>
                <h3>길드원 절찬 대모집중!</h3>
                <p class="neonText">1. 팀투 33만이상</p>
                <p class="neonText">2. 길드전, 길드레이드 참여필수</p>
                <p class="neonText">3. 단톡방 필수</p>
                <p class="neonText">4. 오래오래 함께 하실분</p>
                <p class="neonText"><a href="https://open.kakao.com/o/gdfTMBMc" target="_blank"><i class="fas fa-hand-point-right"></i> 문의하기</a></p>
            </div>
        </div>
        <div id="table_wrap">
            <table class="table table-bordered">
                <thead class=" table-primary">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">쿠폰</th>
                        <th scope="col">보상내역</th>
                        <th scope="col">상태</th>
                        <th scope="col">응답</th>
                        <th scope="col">자세히</th>
                    </tr>
                </thead>
                <tbody id="t_body">

                </tbody>
            </table>
        </div>
    </div>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
   

    <script>
        function setCookie(cookie_name, value, days) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + days);

            var cookie_value = escape(value) + ((days == null) ? '' : '; expires=' + exdate.toUTCString());
            document.cookie = cookie_name + '=' + cookie_value;
        }

        function getCookie(cookie_name) {
            var x, y;
            var val = document.cookie.split(';');

            for (var i = 0; i < val.length; i++) {
                x = val[i].substr(0, val[i].indexOf('='));
                y = val[i].substr(val[i].indexOf('=') + 1);
                x = x.replace(/^\s+|\s+$/g, '');
                if (x == cookie_name) {
                    return unescape(y);
                }
            }

            return null
        }

        let uid = getCookie('uid')

        if (uid) { $('#uid').val(uid) }
        var tabledata = [
            { id: 1, code: "SENA2JOPD", be : "발데르선물(희귀)", result: 0, response: '', description: '' },
            { id: 2, code: "REVIVALRUDY ", be: "지도1000개", result: 0, response: '', description: '' },
            { id: 3, code: "HAPPYSENA2NIGHT", be: "발데르선물(전설)", result: 0, response: '', description: '' },
            { id: 4, code: "superultrageneral", be: "루비500개", result: 0, response: '', description: '' },
            { id: 5, code: "SENA2IDOL", be: "펫조각상자50개", result: 0, response: '', description: '' },
            { id: 6, code: "HOTHOTEVENT", be: "토파즈500개", result: 0, response: '', description: '' },
            { id: 7, code: "UPDATECHECK", be: "보석소환권10개", result: 0, response: '', description: '' },
            { id: 8, code: "SK2OFDESTINY", be: "펫조각상자50개", result: 0, response: '', description: '' },
            { id: 9, code: "ULTIMATEDELLONS", be: "루비500개", result: 0, response: '', description: '' },
            { id: 10, code: "PROMISEAPRIL", be: "루비500개", result: 0, response: '', description: '' },
            { id: 11, code: "GUILDWAR", be: "루비500개", result: 0, response: '', description: '' },
            { id: 12, code: "2mugcup2", be: "보석조각상자50개", result: 0, response: '', description: '' },
            { id: 13, code: "DRESSCODE", be: "의상티켓200개", result: 0, response: '', description: '' },
            { id: 14, code: "YURIGLASS", be: "썬스톤500개", result: 0, response: '', description: '' },
            { id: 15, code: "MICCHECK12", be: "전+무기선택권", result: 0, response: '', description: '' },
            { id: 16, code: "JJAKJJAK2", be: "장비소환티켓10개", result: 0, response: '', description: '' },
            { id: 17, code: "MAILMAILSENAHAJA", be: "전설룬3000개", result: 0, response: '', description: '' },
            { id: 18, code: "SAINTCROSS", be: "루비1000개", result: 0, response: '', description: '' },
            { id: 19, code: "SENAMEMORY", be: "지도1000개", result: 0, response: '', description: '' },
            { id: 20, code: "saveenergy", be: "영웅소환티켓10개", result: 0, response: '', description: '' },
            { id: 21, code: "DESTINYSENA", be: "루비500개", result: 0, response: '', description: '' },
            { id: 22, code: "SK2FRIENDS", be: "전설보석소환권조각30개", result: 0, response: '', description: '' },
            { id: 23, code: "ruuirinjjak", be: "전설엘릭서3000개", result: 0, response: '', description: '' },
            { id: 24, code: "SOTONGHASENA", be: "보석소환티켓10개", result: 0, response: '', description: '' },
            { id: 25, code: "JOPDCHINGUYEO", be: "전설펫소환권조각30개", result: 0, response: '', description: '' },
            { id: 26, code: "Uzzultv", be: "전설영웅선택권", result: 0, response: '', description: '' },
            { id: 27, code: "ANGRYACC", be: "썬스톤500개", result: 0, response: '', description: '' },
            { id: 28, code: "JAKAKATE", be: "장비소환티켓10개", result: 0, response: '', description: '' },
            { id: 29, code: "POKAPOKARONG", be: "루비1000개", result: 0, response: '', description: '' },
            { id: 30, code: "IANS2MING", be: "성장던전티켓상자5개", result: 0, response: '', description: '' },
            { id: 31, code: "NIAJJANGJOA", be: "잊혀진기억조각15개", result: 0, response: '', description: '' },
            { id: 32, code: "KINGGODEVENT", be: "전설+방어구선택권", result: 0, response: '', description: '' },
            { id: 33, code: "TEOVSKYLE", be: "토파즈500개", result: 0, response: '', description: '' },   
            { id: 34, code: "LEGENDTEO", be: "전설보석소환권1개", result: 0, response: '', description: '' },
            { id: 35, code: "SHYCOMESHY", be: "루비1000개", result: 0, response: '', description: '' },
            { id: 36, code: "ALWAYSBANGCHI", be: "루비500개", result: 0, response: '', description: '' },
            { id: 37, code: "sk2growgrow", be: "루비1000개", result: 0, response: '', description: '' },
            { id: 38, code: "BLACKDRAGON", be: "소탕충전권50개", result: 0, response: '', description: '' },
            { id: 39, code: "AUTOMATIC", be: "봉인된장신구선택권3개", result: 0, response: '', description: '' },
            { id: 40, code: "treasureisland", be: "전설영웅소환권", result: 0, response: '', description: '' },
            { id: 41, code: "s2bigupdate", be: "영웅소환권10개", result: 0, response: '', description: '' },
            { id: 42, code: "DARKKNIGHTS", be: "펫소환티켓10개", result: 0, response: '', description: '' },
            { id: 43, code: "Sena2warrior", be: "문스톤300개", result: 0, response: '', description: '' },
            { id: 44, code: "backtothesk2", be: "펫소환티켓10개", result: 0, response: '', description: '' },
            { id: 45, code: "MYPRECIOUS", be: "문스톤300개", result: 0, response: '', description: '' },
            { id: 46, code: "TREASUREHUNTER ", be: "고급지도1000장", result: 0, response: '', description: '' },
            { id: 47, code: "COMINGSOONDELLONS ", be: "전플장신구선택권", result: 0, response: '', description: '' },
            { id: 48, code: "DELLONSVSKRIS ", be: "토파즈500개", result: 0, response: '', description: '' }
        ];
        let str = "";

        for (var a in tabledata) {
            str += `<tr id="tr_${tabledata[a].id}"><th scope = "row">${tabledata[a].id}</th><td>${tabledata[a].code}</td><td>${tabledata[a].be}</td><td>`;

             /*   
            if(tabledata[a].result === 0){
                str += `<i class="fas fa-times"></i>`;
            }else{
                str += `<i class="fas fa-check"></i>`;
            }
            */
            str += `</td><td>${tabledata[a].response}</td><td>${tabledata[a].description}</td></tr >`;
        }    

        $("#t_body").html(str);        


        function req() {
            var uid = $('#uid').val()
            setCookie('uid', uid)
            
            for (var a in tabledata) {
                let i = a
                $.ajax({
                    type: 'POST',
                    url: 'https://couponview.netmarble.com/coupon/sknightsmmo/1443/apply',
                    data: {
                        'pid': uid,
                        'channelCode': 100,
                        'couponCode': tabledata[i]['code'],
                        'worldId': '',
                        'nickname': ''
                    },
                    success: function (data) {
                        console.log(tabledata[i]);
                        if (data['resultCode'] === 'SUCCESS') {
                            tabledata[i]['result'] = 1
                            tabledata[i]['description'] = data['rewardItem']['rewardTitle']
                        } else if (data['resultCode'] === 'NOT_EXISTS_PID') {
                            tabledata[i]['description'] = '없는 회원번호입니다'
                        } else if (data['resultCode'] === 'COUPON_ALREADY_USE') {
                            tabledata[i]['description'] = '이미 사용한 쿠폰번호입니다.'
                        } else if (data['resultCode'] === 'COUPON_WRONG') {
                            tabledata[i]['description'] = '잘못된 쿠폰 번호입니다.'
                        } else {
                            tabledata[i]['description'] = '에러'
                        }
                        tabledata[i]['response'] = data['resultCode']

                        let str = `<th scope = "row">${tabledata[i].id}</th><td>${tabledata[i].code}</td><td>${tabledata[i].be}</td><td>`;
                        
                        if (tabledata[i].result === 0) {
                            str += `<i class="fas fa-times"></i>`;
                        } else {
                            str += `<i class="fas fa-check"></i>`;
                        }    

                        str += `</td><td>${tabledata[i].response}</td><td>${tabledata[i].description}</td>`;
                        
                        $("#tr_" + tabledata[i].id).html(str);

                        
                        console.log(data);
                       // table.updateData(tabledata)
                    }
                })
            }
        }

    </script>
</body>

</html>
